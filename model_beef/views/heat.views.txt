CREATE MATERIALIZED VIEW view_bld_gws_wareas as 
 SELECT b.bkey,
    b.bid,
    sum(g.warea) AS wareas,
    count(g.warea) AS count
   FROM gwrmatches2 b,
    gwr g
  WHERE b.egid = g.egid
  GROUP BY b.bkey, b.bid;

For each EGID ratio of WAREA of the building to the sum of WAREA of all gws points mapping to the same building footprint:

CREATE MATERIALIZED VIEW mview_warea_ratio as 
 SELECT b.bkey,
    b.bid,
    g.warea / c.wareas AS ratio
   FROM gwr g,
    gwrmatches2 b,
    ( SELECT b_1.bid,
            b_1.bkey,
            sum(g_1.warea) AS wareas
           FROM gwr g_1,
            gwrmatches2 b_1
          WHERE g_1.egid = b_1.egid
          GROUP BY b_1.bid, b_1.bkey) c
  WHERE g.egid = b.egid AND b.bid = c.bid AND b.bkey::text = c.bkey::text;
